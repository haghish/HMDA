% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmda.best.models.R
\name{hmda.best.models}
\alias{hmda.best.models}
\title{Select Best Models Across All Models in HMDA Grid}
\usage{
hmda.best.models(
  df,
  n_models = NULL,
  distance_percentage = NULL,
  metrics = c("logloss", "mae", "mse", "rmse", "rmsle", "mean_per_class_error", "auc",
    "aucpr", "r2", "accuracy", "f1", "mcc", "f2"),
  hyperparam = FALSE
)
}
\arguments{
\item{df}{A data frame of class \code{"hmda.grid.analysis"} containing
model performance results. It must include a column named
\code{model_ids}.}

\item{n_models}{Integer. The number of top models to select per metric.
If both \code{n_models} and \code{distance_percentage} are \code{NULL},
defaults to 1.}

\item{distance_percentage}{Numeric in (0, 1). Alternative to \code{n_models}. Selects all models within
a given percentage of the best value for each metric (direction-aware). You must specify either
\code{n_models} or \code{distance_percentage}, not both.}

\item{metrics}{Character vector of performance metric column names to consider. Only metrics present
in \code{df} are used.}

\item{hyperparam}{Logical. If \code{TRUE}, returns all columns for the selected models (including
hyperparameters). If \code{FALSE}, returns only \code{model_ids} plus the selected metric columns.}
}
\value{
A data frame containing the union of selected models across all considered metrics.
  If \code{hyperparam = FALSE}, the output includes \code{model_ids} and the metric columns found in \code{df}.
  If \code{hyperparam = TRUE}, the output includes all columns from \code{df} for the selected models.
}
\description{
Scans an HMDA grid analysis data frame for performance metric columns and, for each metric,
selects the best-performing models according to the correct optimization direction
(lower is better for some metrics; higher is better for others). The function returns a
subset of the input data frame containing the union of selected model IDs.
}
\details{
The function uses a predefined set of H2O performance metrics along with
  their desired optimization directions:
  \describe{
    \item{logloss, mae, mse, rmse, rmsle, mean_per_class_error}{Lower values
          are better.}
    \item{auc, aucpr, r2, accuracy, f1, mcc, f2}{Higher values are better.}
  }
}
\examples{
\dontrun{
  # Example: Create a hyperparameter grid for GBM models.
  predictors <- c("var1", "var2", "var3")
  response <- "target"

  # Define hyperparameter ranges
  hyper_params <- list(
    ntrees = seq(50, 150, by = 25),
    max_depth = c(5, 10, 15),
    learn_rate = c(0.01, 0.05, 0.1),
    sample_rate = c(0.8, 1.0),
    col_sample_rate = c(0.8, 1.0)
  )

  # Run the grid search
  grid <- hmda.grid(
    algorithm = "gbm",
    x = predictors,
    y = response,
    training_frame = h2o.getFrame("hmda.train.hex"),
    hyper_params = hyper_params,
    nfolds = 10,
    stopping_metric = "AUTO"
  )

  # Assess the performances of the models
  grid_performance <- hmda.grid.analysis(grid)

  # Return the best 2 models according to each metric
  hmda.best.models(grid_performance, n_models = 2)

  # return all models with performance metric as high as 98\% of the best model, for each metric
  hmda.best.models(grid_performance, distance_percentage = 0.98)
}

}
\author{
E. F. Haghish
}
